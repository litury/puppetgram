# Channel Parser Module

–ú–æ–¥—É–ª—å –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ Telegram –∫–∞–Ω–∞–ª–æ–≤ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤, —Å—Å—ã–ª–æ–∫ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üîç –ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∫–∞–Ω–∞–ª–∞
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞, –¥–∞—Ç, –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤, –ø–µ—Ä–µ—Å—ã–ª–æ–∫
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∞–∫—Ü–∏–π –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–µ—Ä–µ—Å—ã–ª–∫–∞—Ö –∏ –æ—Ç–≤–µ—Ç–∞—Ö

### üì∏ –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã

- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π, –≤–∏–¥–µ–æ, –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞—É–¥–∏–æ –∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –ê–Ω–∏–º–∞—Ü–∏–∏ –∏ —Å—Ç–∏–∫–µ—Ä—ã
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∏–ø–æ–≤ –∏ —Ä–∞–∑–º–µ—Ä–æ–≤ –º–µ–¥–∏–∞

### üîó –°—Å—ã–ª–∫–∏ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Å—ã–ª–æ–∫ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏–π
- –°–æ–∑–¥–∞–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –ø–æ—Å—Ç—ã
- –•—ç—à—Ç–µ–≥–∏ –∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è
- –í–Ω–µ—à–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### üìä –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

- JSON —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- TXT —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π
- CSV —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Ç–∞–±–ª–∏—Ü
- –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
npm run parse-channel
```

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```typescript
import { ChannelParserService } from "./modules/channelParser";
import { GramClient } from "./telegram/adapters/gramClient";

const gramClient = new GramClient();
await gramClient.connect();

const parser = new ChannelParserService(gramClient.getClient());

const result = await parser.parseChannelAsync("@channel_name", {
  downloadMedia: true,
  mediaTypes: ["photo", "video", "document"],
  maxMediaSize: 50, // MB
});
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

### –§–∞–π–ª—ã —ç–∫—Å–ø–æ—Ä—Ç–∞

```
exports/channel-parser/
‚îú‚îÄ‚îÄ channel_name_2025-01-15T10-30-00-000Z.json    # –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ channel_name_2025-01-15T10-30-00-000Z.txt     # –¢–µ–∫—Å—Ç –¥–ª—è –ò–ò
‚îú‚îÄ‚îÄ channel_name_2025-01-15T10-30-00-000Z.csv     # –¢–∞–±–ª–∏—Ü–∞
‚îú‚îÄ‚îÄ channel_name_2025-01-15T10-30-00-000Z_stats.json # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
‚îî‚îÄ‚îÄ media/                                          # –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã
    ‚îú‚îÄ‚îÄ 1234_2025-01-15T10-30-00-000Z.jpg
    ‚îú‚îÄ‚îÄ 1235_2025-01-15T10-30-00-000Z.mp4
    ‚îî‚îÄ‚îÄ ...
```

### JSON —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```json
{
  "metadata": {
    "exportedAt": "2025-01-15T10:30:00.000Z",
    "parser": "ChannelParserService v1.0",
    "channel": {
      "id": "123456789",
      "username": "@channel_name",
      "title": "Channel Title",
      "totalMessages": 1500
    }
  },
  "messages": [
    {
      "id": 1234,
      "text": "–°–æ–æ–±—â–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç",
      "date": "2025-01-15T10:00:00.000Z",
      "views": 1500,
      "forwards": 25,
      "media": [
        {
          "type": "photo",
          "filename": "1234_2025-01-15T10-30-00-000Z.jpg",
          "size": 245760,
          "localPath": "/path/to/file.jpg",
          "dimensions": { "width": 1920, "height": 1080 }
        }
      ],
      "links": [
        {
          "url": "https://example.com",
          "text": "example.com",
          "type": "url"
        }
      ],
      "originalUrl": "https://t.me/channel_name/1234",
      "hashtags": ["#coding", "#telegram"],
      "mentions": ["@username"]
    }
  ]
}
```

## –û–ø—Ü–∏–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞

### IChannelParseOptions

```typescript
interface IChannelParseOptions {
  downloadMedia?: boolean; // –°–∫–∞—á–∏–≤–∞—Ç—å –º–µ–¥–∏–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: true)
  mediaDirectory?: string; // –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –º–µ–¥–∏–∞
  maxMediaSize?: number; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –≤ MB (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 50)
  mediaTypes?: MediaType[]; // –¢–∏–ø—ã –º–µ–¥–∏–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
  includeDeleted?: boolean; // –í–∫–ª—é—á–∞—Ç—å —É–¥–∞–ª–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
}
```

### –¢–∏–ø—ã –º–µ–¥–∏–∞

- `photo` - –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
- `video` - –í–∏–¥–µ–æ —Ñ–∞–π–ª—ã
- `document` - –î–æ–∫—É–º–µ–Ω—Ç—ã
- `audio` - –ê—É–¥–∏–æ —Ñ–∞–π–ª—ã
- `voice` - –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- `animation` - –ê–Ω–∏–º–∞—Ü–∏–∏/GIF
- `sticker` - –°—Ç–∏–∫–µ—Ä—ã

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

### –î–ª—è Twitter –ø–æ—Å—Ç–∏–Ω–≥–∞

```typescript
// –ò—Å–ø–æ–ª—å–∑—É–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Twitter –∫–æ–Ω—Ç–µ–Ω—Ç–∞
const channelData = JSON.parse(fs.readFileSync("channel_export.json", "utf-8"));

for (const message of channelData.messages) {
  // –°–æ–∑–¥–∞–µ–º –ø–æ—Å—Ç —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–æ–π
  const twitterPost = {
    content: message.text,
    originalUrl: message.originalUrl,
    media: message.media?.map((m) => m.localPath),
  };
}
```

### –î–ª—è –í–ö–æ–Ω—Ç–∞–∫—Ç–µ

```typescript
// –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –ø–æ—Å—Ç—ã
for (const message of channelData.messages) {
  const vkPost = {
    text: message.text,
    source: message.originalUrl, // –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–µ—Ä–≤–æ–∏—Å—Ç–æ—á–Ω–∏–∫
  };
}
```

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

–ú–æ–¥—É–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:

- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π
- –°–æ–æ–±—â–µ–Ω–∏—è —Å –º–µ–¥–∏–∞
- –°–∫–∞—á–∞–Ω–Ω—ã–µ –º–µ–¥–∏–∞ —Ñ–∞–π–ª—ã
- –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä –º–µ–¥–∏–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Å—ã–ª–æ–∫, —Ö—ç—à—Ç–µ–≥–æ–≤, —É–ø–æ–º–∏–Ω–∞–Ω–∏–π
- –í—Ä–µ–º—è –ø–∞—Ä—Å–∏–Ω–≥–∞
- –°–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –û–±—Ä–∞–±–æ—Ç–∫–∞ ~100 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å–µ–∫—É–Ω–¥—É
- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü—Ä–æ–ø—É—Å–∫ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–ú–æ–¥—É–ª—å —Å–æ–≤–º–µ—Å—Ç–∏–º —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏:

- `GramClient` - –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Telegram
- `MessageFetcher` - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
- `ExportService` - –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
